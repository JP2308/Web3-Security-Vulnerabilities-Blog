---
title: "Critical Vulnerabilities in OpenSSH and HFS Servers: A Security Overview"
date: 2024-07-09
categories: [Security, Vulnerabilities, RCE, Malware]
---

July 2024 delivered two security incidents that perfectly encapsulate everything frustrating about infrastructure security. On one hand, we have OpenSSH ‚Äî arguably one of the most scrutinised network services on the planet ‚Äî reintroducing a vulnerability from 2006. On the other, we have organisations still running decade-old file servers that were never meant for production use. Both scenarios highlight the same uncomfortable truth: our security is only as strong as the software we forgot we were running.

## üîê OpenSSH's "regreSSHion": A Lesson in Regression Testing
The OpenSSH vulnerability (CVE-2024-6387) is the kind of bug that makes you question everything. Here's a service that's been battle-tested for decades, audited by security researchers worldwide, and considered the gold standard for secure remote access. Yet somehow, during code refactoring between versions 8.5p1 and 9.7p1, developers managed to reintroduce a signal handler race condition that was originally patched in 2006.

The Technical Reality:
```c
// Simplified representation of the vulnerability
void signal_handler(int sig) {
    // VULNERABILITY: Non-async-signal-safe operations
    // in signal handler create race condition
    syslog(LOG_INFO, "Received signal %d", sig);
    // ... other unsafe operations
}

// During SSH authentication process:
// 1. Client connects
// 2. Authentication times out
// 3. Signal handler executes
// 4. Race condition allows memory corruption
// 5. Attacker gains root access
```

What makes this particularly dangerous is the simplicity of the attack surface. An unauthenticated attacker can achieve remote code execution with root privileges just by maintaining connections for several hours. No credentials needed, no user interaction required ‚Äî just patience.

### So what? 
Well in my view, this vulnerability exposes something more concerning than just a coding mistake. The fact that this is a regression tells us that even mature, well-maintained codebases can slide backwards during routine maintenance. How many other "fixed" vulnerabilities are lurking in our supposedly secure systems?

### The saving grace? 
OpenBSD systems are completely unaffected due to their security-first design decisions made years ago. This isn't luck ‚Äî it's the result of architectural choices that assume signal handling will eventually break.

### Practically, What You Should Do?:

- Upgrade to OpenSSH 9.8 immediately (not next week, not next month)
- Implement connection rate limiting if you haven't already
- Consider this a wake-up call to audit your other "bulletproof" services
- Document your SSH configurations because undocumented systems become unmaintained systems


## üñ•Ô∏è HFS Exploitation: The File Server Time Forgot

While OpenSSH's vulnerability was sophisticated, the HFS story is depressingly simple. Attackers have been actively targeting Rejetto's HTTP File Server version 2.3m, exploiting CVE-2024-23692 to deploy malware and Monero miners. This vulnerability allows arbitrary command execution without authentication ‚Äî essentially turning any HFS server into an open invitation for attackers.

### The Exploitation Flow:

```python
# Simplified attack against HFS 2.3m
def exploit_hfs_server(target_url):
    # CVE-2024-23692: Command injection via search parameter
    payload = "search='; powershell -c 'invoke malware'"
    
    response = requests.post(f"{target_url}/", data=payload)
    
    if response.status_code == 200:
        # Deploy Monero miner
        deploy_cryptocurrency_miner()
        # Establish persistence
        create_backdoor()
        
    return "Server compromised"
```
### The Uncomfortable Truth:
Rejetto has essentially abandoned ship, advising users to stop using HFS versions 2.3m through 2.4 entirely. This isn't a "patch and continue" situation ‚Äî it's an "evacuate immediately" moment. Yet these servers keep running because they exist in that dangerous gray area between official IT infrastructure and shadow IT. The scary factor for me was where the servers were located: educational institutions and small teams who set up HFS years ago for "temporary" file sharing and then... forgot about it.

### The Bigger Picture:
This attack pattern reveals something uncomfortable about how we actually manage infrastructure. HFS servers persist because they solve real problems ‚Äî people need to share files, and HFS "just works." But "just works" often means "works until someone exploits it to mine cryptocurrency on your hardware." Personally, I think the choice of Monero mining as the payload is telling. Attackers aren't just looking for data; they're looking for computational resources they can monetise. Your "simple" file server becomes their profit center.

## üß† What These Incidents Actually Teach Us
These vulnerabilities might seem unrelated, but they expose fundamental truths about security that we keep ignoring:
### "Mature" Software Isn't Immune:
The OpenSSH regression shows us that even actively maintained, critical software can reintroduce old vulnerabilities. Every refactoring, every optimisation, every "harmless" change carries risk. This is why security isn't a destination ‚Äî it's an ongoing process that requires constant vigilance.
### Shadow IT Is Everyone's Problem:
The HFS attacks succeed because these servers exist in the gaps of organisational memory. How many services are running in your environment right now that someone set up years ago and forgot about? Your security is only as strong as your least-maintained service.
### The Sophistication Spectrum:
Not all attacks need to be sophisticated to be effective. The OpenSSH exploit requires technical skill and patience, while the HFS exploit is point-and-click simple. Defenders need to be prepared for both ends of this spectrum.
### Infrastructure Archaeology Matters:
Both incidents highlight the importance of knowing what you're running. The OpenSSH vulnerability affects specific version ranges. The HFS vulnerability affects software that should have been retired years ago. You can't secure what you don't know exists.
### Detection vs. Prevention:
An important lesson for me is how large a role monitoring plays in security. The OpenSSH attacks require sustained connections that should be visible in logs. The HFS attacks result in cryptocurrency mining that should be detectable through system monitoring. Perfect prevention is impossible, but good detection makes all the difference.

