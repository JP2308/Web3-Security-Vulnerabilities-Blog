---
title: "Lazarus APT's Deceptive Campaigns: Tank Game Malware and NFT Lures"
date: 2024-11-01
categories: [Security, DeFi, Malware, APT]
---

## üéÆ Lazarus APT Steals Crypto via Decoy Tank Game

In October 2024, Kaspersky uncovered a sophisticated attack by the Lazarus APT group, leveraging a decoy multiplayer online battle arena (MOBA) game to distribute malware and steal cryptocurrency.

### üß© Attack Overview

- **Fake Game**: The attackers developed a fake game, DeTankZone, resembling the classic "Battle City" game.
- **Exploitation**: The game was distributed through a website that exploited two vulnerabilities in Google Chrome:
  - **CVE-2024-4947**: A vulnerability in the V8 JavaScript engine's Maglev compiler, allowing for arbitrary memory read/write operations.
  - **V8 Sandbox Bypass**: A technique to escape the browser's security sandbox, enabling the execution of malicious code outside the browser's restricted environment.

Upon visiting the malicious website, the exploit was triggered, leading to the installation of a backdoor on the victim's system.

### üß™ Technical Details

- **Game Server Communication**: The game communicated with a server at `api.detankzone.com` using the Socket.IO protocol.
- **Encryption**: Data exchanged between the game client and server was encrypted using AES-256 with a hardcoded key: `Full Stack IT Service 198703Game`.
- **Reverse Engineering**: Kaspersky researchers reverse-engineered the game client and developed a custom server to analyse its behavior.

### üß† Attribution and Motivation

The attack is attributed to Lazarus APT due to:

- **Targeting of Cryptocurrency Users**: The game was promoted in cryptocurrency communities.
- **Use of Zero-Day Exploits**: The exploitation of previously unknown vulnerabilities.
- **Advanced Technical Capabilities**: The development of a custom game client and server infrastructure.

This campaign highlights Lazarus APT's evolving tactics in targeting the cryptocurrency sector.

---

## ü¶´ Bored BeaverTail Yacht Club ‚Äì A Lazarus Lure

In a separate campaign, eSentire analysed an attack involving a malicious Node.js package named BeaverTail, distributed through a fake NFT project called "Bored BeaverTail Yacht Club."

### üß© Attack Flow

1. **Initial Access**: A developer downloaded a ZIP file named `task-space-eshop-aeea6cc51a7c.zip` from a Bitbucket repository.
2. **Malicious Package Installation**: The ZIP file contained a Node.js package that, when installed, executed a malicious script (`server.js`).
3. **Payload Delivery**: The script downloaded additional payloads from a command-and-control server at `185.235.241.208:1224`.
4. **Execution of InvisibleFerret**: The payload included Python-based malware known as **InvisibleFerret**, which:
   - Stole browser credentials.
   - Enumerated cryptocurrency wallet extensions.
   - Exfiltrated configuration data from wallets like Exodus and Solana.

### üîç Indicators of Compromise

- **Command Line Execution**: The malware attempted to execute a cURL command to download the payload.
- **Process Tree Analysis**: The execution was observed through a process tree showing the launch of `test.js` and subsequent network activity.
- **Blocked Activity**: eSentire's endpoint protection successfully blocked the malicious activities, preventing further compromise.

### üß† Attribution and Campaign Context

This attack is consistent with Lazarus APT's Contagious Interview campaign (see last month's post titled 'Tapioca DAO Social Engineering Exploit: $4.65M Loss, Lessons in DeFi Security'), which targets software developers through fraudulent job offers. The use of a fake NFT project as a lure aligns with previous tactics observed in Lazarus APT's operations.

---

## üõ°Ô∏è Mitigation Strategies

To protect against such sophisticated attacks:

- **Regularly Update Software**: Ensure all software, including browsers and development tools, are up-to-date to mitigate known vulnerabilities.
- **Verify Sources**: Only download software and packages from trusted sources.
- **Use Endpoint Protection**: Implement robust endpoint protection solutions to detect and block malicious activities.
- **Educate Developers**: Provide training to developers on recognising phishing attempts and malicious packages.

---

## üß† Common Vulnerabilities in DAO Governance

I read a really interesting article by Sigma Prime titled "Common Vulnerabilities: Protocol Governance and DAOs." It discusses prevalent security issues in Decentralised Autonomous Organisations (DAOs) and offers mitigation strategies.

### üîç Key Vulnerabilities

1. **Reentrancy Attacks**: Exploited in the 2016 DAO hack, allowing attackers to drain funds by recursively calling withdrawal functions.
   - **Mitigation**: Use `nonReentrant` modifiers and follow the "Checks-Effects-Interactions" pattern.

2. **Insider Threats**: Malicious or compromised insiders can exploit governance mechanisms to siphon funds.
   - **Mitigation**: Implement multi-signature wallets and enforce strict access controls.

3. **Flash Loan Attacks**: Manipulating governance votes by borrowing large amounts of tokens to influence decisions.
   - **Mitigation**: Introduce voting delays and minimum holding periods for tokens.

4. **Proposal Contract Vulnerabilities**: Flaws in smart contracts used for submitting proposals can be exploited.
   - **Mitigation**: Carefully analyse submitted proposal contracts and use standardised templates.

### üéØ Recommendations

- **Emergency Response Drills**: Larger DAOs should practice emergency response war games to test their protocol monitoring and response capabilities.
- **Regular Audits**: Conduct regular security audits of governance contracts and voting mechanisms.
- **Community Engagement**: Foster a vigilant community to report suspicious activities and potential vulnerabilities.
